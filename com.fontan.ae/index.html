<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FONTAN</title>
    <link rel="stylesheet" href="css/styles.css">
    <!-- No global error handler needed as debug phase is over -->
</head>

<body>
    <div class="panel">
        <!-- Status Bar (Moved to Top) -->
        <header class="status-bar" style="border-top: none; border-bottom: 1px solid #000;">
            <span class="status-text" id="status-text">Ready</span>
            <div class="status-indicator" id="status-indicator"></div>
        </header>

        <!-- Header -->
        <header class="header">
            <div class="logo">
                <img class="logo-icon" src="icons/logo.svg" alt="Fontan AE">
            </div>
            <div class="header-actions">
                <button class="btn btn-icon-only btn-secondary" id="btn-updates" title="Updates">
                    <svg viewBox="0 0 24 24" fill="none">
                        <path d="M18 8a6 6 0 1 0-12 0c0 7-3 7-3 9h18c0-2-3-2-3-9" stroke="currentColor" stroke-width="2"
                            stroke-linecap="round" stroke-linejoin="round" />
                        <path d="M13.73 21a2 2 0 0 1-3.46 0" stroke="currentColor" stroke-width="2"
                            stroke-linecap="round" stroke-linejoin="round" />
                    </svg>
                </button>
                <button class="btn btn-icon-only btn-secondary" id="btn-about" title="About">
                    <svg viewBox="0 0 24 24" fill="none">
                        <circle cx="12" cy="12" r="9" stroke="currentColor" stroke-width="2" />
                        <path d="M12 10v6" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                        <path d="M12 7h.01" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                    </svg>
                </button>
            </div>
        </header>

        <!-- Tabs -->
        <nav class="tabs">
            <button class="tab active" data-tab="create">
                <svg class="tab-icon" viewBox="0 0 24 24" fill="none">
                    <path d="M12 5V19M5 12H19" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                </svg>
                Add Layers
            </button>
            <button class="tab" data-tab="anim">
                <svg class="tab-icon" viewBox="0 0 24 24" fill="none">
                    <path d="M14.5 12a2.5 2.5 0 1 1-5 0 2.5 2.5 0 0 1 5 0z" stroke="currentColor" stroke-width="2" />
                    <path
                        d="M12 2v2M12 20v2M4.93 4.93l1.41 1.41M17.66 17.66l1.41 1.41M2 12h2M20 12h2M6.34 17.66l-1.41 1.41M19.07 4.93l-1.41 1.41"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                </svg>
                Animation
            </button>
            <button class="tab" data-tab="fix">
                <svg class="tab-icon" viewBox="0 0 24 24" fill="none">
                    <path
                        d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                </svg>
                Fix
            </button>
        </nav>

        <!-- Tab Content -->
        <main class="tab-content">
            <!-- CREATE TAB -->
            <section id="tab-create" class="tab-panel active">
                <!-- Layer List -->
                <div class="section">
                    <div class="section-header">
                        <span class="section-title">Text Layers</span>
                        <span class="layer-count" id="layer-count">0 layers</span>
                    </div>
                    <div class="list-container is-empty" id="layer-list">
                        <div class="empty-state">
                            <svg class="empty-icon" viewBox="0 0 24 24" fill="none">
                                <path d="M4 7V4H20V7" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                                <path d="M9 20H15" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                                <path d="M12 4V20" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                            </svg>
                            <p>Select text layers and click +</p>
                        </div>
                    </div>
                </div>

                <!-- Layer Controls -->
                <div class="button-row">
                    <button class="btn btn-icon-only btn-primary" id="btn-add" title="Add Selected">
                        <svg class="btn-icon" viewBox="0 0 24 24" fill="none">
                            <path d="M12 5V19M5 12H19" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                        </svg>
                    </button>
                    <button class="btn btn-icon-only" id="btn-remove" title="Remove">
                        <svg viewBox="0 0 24 24" fill="none">
                            <path d="M18 6L6 18M6 6L18 18" stroke="currentColor" stroke-width="2"
                                stroke-linecap="round" />
                        </svg>
                    </button>
                    <button class="btn btn-icon-only" id="btn-up" title="Move Up">
                        <svg viewBox="0 0 24 24" fill="none">
                            <path d="M12 19V5M5 12L12 5L19 12" stroke="currentColor" stroke-width="2"
                                stroke-linecap="round" stroke-linejoin="round" />
                        </svg>
                    </button>
                    <button class="btn btn-icon-only" id="btn-down" title="Move Down">
                        <svg viewBox="0 0 24 24" fill="none">
                            <path d="M12 5V19M5 12L12 19L19 12" stroke="currentColor" stroke-width="2"
                                stroke-linecap="round" stroke-linejoin="round" />
                        </svg>
                    </button>
                </div>

                <div class="button-row">
                    <button class="btn btn-secondary is-hidden" id="btn-anim-settings">
                        Animation Settings
                    </button>
                </div>

                <div class="checkbox-row" style="margin-top: 8px;">
                    <label class="checkbox">
                        <input type="checkbox" id="cb-delete-originals">
                        <span class="checkbox-mark"></span>
                        <span class="checkbox-label">Delete original text layers</span>
                    </label>
                    <div class="checkbox-help">Remove source text layers after creating shapes.</div>
                </div>

                <div class="font-status" id="font-status">
                    <span class="font-status-text" id="font-status-text"></span>
                </div>

                <div class="button-row" style="margin-top: 12px;">
                    <p style="color:#666; font-size:11px;">Go to <b>Anim</b> tab to configure and create animation.</p>
                </div>
            </section>

            <!-- ANIM TAB -->
            <section id="tab-anim" class="tab-panel">
                <!-- Options -->
                <div class="checkbox-row">
                    <label class="checkbox">
                        <input type="checkbox" id="cb-align" checked>
                        <span class="checkbox-mark"></span>
                        <span class="checkbox-label">Align Paths (Morph)</span>
                    </label>
                    <div class="checkbox-help">Aligns shape vertices for cleaner morphing.</div>
                </div>
                <div class="checkbox-row">
                    <label class="checkbox">
                        <input type="checkbox" id="cb-loop">
                        <span class="checkbox-mark"></span>
                        <span class="checkbox-label">Loop Animation</span>
                    </label>
                    <div class="checkbox-help">Mirrors keys to create a seamless loop.</div>
                </div>

                <!-- Animation Panel -->
                <div class="panel-section">
                    <div class="panel-header">
                        <div class="panel-header-title">
                            <svg class="panel-icon" viewBox="0 0 24 24" fill="none">
                                <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" />
                                <path d="M12 6V12L16 14" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                            </svg>
                            Keyframes
                        </div>
                        <label class="switch switch-sm" title="Enable Offsets">
                            <input type="checkbox" id="cb-offset-enable" checked>
                            <span class="switch-slider"></span>
                        </label>
                    </div>
                    <div class="panel-body">
                        <div class="input-group">
                            <label class="input-label">Animation Duration</label>
                            <input type="number" class="input" id="input-offset" value="15" min="1" max="300">
                        </div>
                        <div class="input-row">
                            <div class="input-group flex-1">
                                <label class="input-label">Wave Step (frames)</label>
                                <input type="number" class="input" id="input-stagger" value="2" min="0" max="100">
                            </div>
                            <div class="input-group flex-1">
                                <label class="input-label">Direction</label>
                                <select class="select" id="select-direction">
                                    <option value="top">Top to Bottom</option>
                                    <option value="bottom">Bottom to Top</option>
                                </select>
                            </div>
                        </div>
                        <div class="input-group">
                            <label class="input-label">Easing</label>
                            <div class="input-row align-center">
                                <select class="select flex-1" id="select-ease">
                                    <option value="ease">Easy Ease</option>
                                    <option value="ease_in">Easy In</option>
                                    <option value="ease_out">Easy Out</option>
                                    <option value="ease_in_out">Easy In-Out</option>
                                    <option value="linear">Linear</option>
                                    <option value="custom">Custom</option>
                                </select>
                                <button class="btn btn-icon-only btn-secondary" id="btn-ease-editor" title="Edit Bezier">
                                    <svg viewBox="0 0 24 24" fill="none">
                                        <path d="M4 16c3-6 13-6 16 0" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                                        <circle cx="4" cy="16" r="2" stroke="currentColor" stroke-width="2" />
                                        <circle cx="20" cy="16" r="2" stroke="currentColor" stroke-width="2" />
                                    </svg>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Centering Panel -->
                <div class="panel-section">
                    <div class="panel-header">
                        <div class="panel-header-title">
                            <svg class="panel-icon" viewBox="0 0 24 24" fill="none">
                                <rect x="3" y="3" width="18" height="18" rx="2" stroke="currentColor" stroke-width="2" />
                                <line x1="12" y1="3" x2="12" y2="21" stroke="currentColor" stroke-width="2" />
                                <line x1="3" y1="12" x2="21" y2="12" stroke="currentColor" stroke-width="2" />
                            </svg>
                            Alignment
                        </div>
                        <label class="switch">
                            <input type="checkbox" id="cb-center-enable">
                            <span class="switch-slider"></span>
                        </label>
                    </div>
                    <div class="panel-body">
                        <div class="input-row">
                            <select class="select" id="select-center-mode" disabled>
                                <option value="center">Center</option>
                                <option value="left">Left</option>
                                <option value="right">Right</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Action Buttons -->
                <div class="action-buttons">
                    <button class="btn btn-primary btn-large" id="btn-apply">
                        <svg class="btn-icon" viewBox="0 0 24 24" fill="none">
                            <path d="M20 6L9 17L4 12" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                stroke-linejoin="round" />
                        </svg>
                        Create Animation
                    </button>
                </div>
            </section>


            <!-- FIX TAB -->
            <section id="tab-fix" class="tab-panel">
                <!-- Shape Layer Picker -->
                <div class="section">
                    <div class="section-header">
                        <span class="section-title">Shape Layer</span>
                    </div>
                    <div class="input-row">
                        <select class="select flex-1" id="select-shape">
                            <option value="">-- Select Shape Layer --</option>
                        </select>
                        <button class="btn btn-icon-only btn-secondary" id="btn-refresh" title="Refresh">
                            <svg viewBox="0 0 24 24" fill="none">
                                <path d="M21 12a9 9 0 1 1-3-6" stroke="currentColor" stroke-width="2"
                                    stroke-linecap="round" stroke-linejoin="round" />
                                <path d="M21 4v6h-6" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round" />
                            </svg>
                        </button>
                    </div>
                </div>

                <!-- Groups List -->
                <div class="section">
                    <div class="section-header">
                        <span class="section-title">Top Groups</span>
                        <span class="group-count" id="group-count">0 groups</span>
                    </div>
                    <div class="list-container list-tall" id="group-list">
                        <div class="empty-state">
                            <svg class="empty-icon" viewBox="0 0 24 24" fill="none">
                                <rect x="3" y="3" width="7" height="7" stroke="currentColor" stroke-width="2" />
                                <rect x="14" y="3" width="7" height="7" stroke="currentColor" stroke-width="2" />
                                <rect x="3" y="14" width="7" height="7" stroke="currentColor" stroke-width="2" />
                                <rect x="14" y="14" width="7" height="7" stroke="currentColor" stroke-width="2" />
                            </svg>
                            <p>Select a shape layer to view groups</p>
                        </div>
                    </div>
                </div>

            </section>
        </main>


    </div>

    <!-- Progress Overlay -->
    <div class="overlay" id="overlay">
        <div class="progress-modal">
            <div class="spinner"></div>
            <p class="progress-text" id="progress-text">Processing...</p>
        </div>
    </div>

    <!-- About Modal -->
    <div class="modal" id="about-modal" aria-hidden="true">
        <div class="modal-content">
            <div class="modal-header">
                <span>About</span>
                <button class="btn btn-icon-only" id="btn-about-close" title="Close">
                    <svg viewBox="0 0 24 24" fill="none">
                        <path d="M18 6L6 18M6 6L18 18" stroke="currentColor" stroke-width="2"
                            stroke-linecap="round" />
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <div class="about-title">FONTAN AE</div>
                <div class="about-desc">Text to shapes animation tool for After Effects.</div>
                <div class="about-meta">Version: 0.2</div>
                <div class="about-list-title">Supported Fonts</div>
                <ul class="about-list">
                    <li>Inter</li>
                    <li>Neue Haas Grotesk</li>
                    <li>Montserrat</li>
                    <li>Roboto Condensed</li>
                    <li>Futura PT</li>
                    <li>IBM Plex Sans</li>
                </ul>
                <div class="about-actions">
                    <button class="btn btn-secondary" data-link="https://t.me/fontan">Telegram</button>
                    <button class="btn btn-secondary" data-link="https://fontan.ae/docs">Manual</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Updates Modal -->
    <div class="modal" id="updates-modal" aria-hidden="true">
        <div class="modal-content">
            <div class="modal-header">
                <span>Updates</span>
                <button class="btn btn-icon-only" id="btn-updates-close" title="Close">
                    <svg viewBox="0 0 24 24" fill="none">
                        <path d="M18 6L6 18M6 6L18 18" stroke="currentColor" stroke-width="2"
                            stroke-linecap="round" />
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <div class="about-title">Status</div>
                <div class="about-desc">You're up to date.</div>
                <div class="about-meta">Last checked: just now</div>
            </div>
        </div>
    </div>

    <!-- Easing Modal -->
    <div class="modal" id="easing-modal" aria-hidden="true">
        <div class="modal-content">
            <div class="modal-header">
                <span>Custom Bezier</span>
                <button class="btn btn-icon-only" id="btn-ease-close" title="Close">
                    <svg viewBox="0 0 24 24" fill="none">
                        <path d="M18 6L6 18M6 6L18 18" stroke="currentColor" stroke-width="2"
                            stroke-linecap="round" />
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <div class="curve-editor">
                    <svg id="easing-graph" viewBox="0 0 200 140">
                        <rect x="0" y="0" width="200" height="140" rx="6" ry="6" fill="#1f1f1f" stroke="#333" />
                        <path id="curve-path" d="" stroke="#00a8ff" stroke-width="2" fill="none" />
                        <line id="curve-line-1" x1="0" y1="140" x2="0" y2="140" stroke="#444" stroke-width="1" />
                        <line id="curve-line-2" x1="200" y1="0" x2="200" y2="0" stroke="#444" stroke-width="1" />
                        <circle id="curve-handle-1" cx="0" cy="140" r="5" fill="#00a8ff" />
                        <circle id="curve-handle-2" cx="200" cy="0" r="5" fill="#00a8ff" />
                    </svg>
                    <div class="curve-values" id="curve-values">P1: 0.25, 0.10 â€¢ P2: 0.25, 1.00</div>
                </div>
                <div class="about-actions">
                    <button class="btn btn-secondary" id="btn-ease-cancel">Cancel</button>
                    <button class="btn btn-primary" id="btn-ease-ok">OK</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Fix Vectors Modal -->
    <div class="modal" id="vector-modal" aria-hidden="true">
        <div class="modal-content modal-wide">
            <div class="modal-header">
                <span>Fix Vectors</span>
                <button class="btn btn-icon-only" id="btn-vector-close" title="Close">
                    <svg viewBox="0 0 24 24" fill="none">
                        <path d="M18 6L6 18M6 6L18 18" stroke="currentColor" stroke-width="2"
                            stroke-linecap="round" />
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <div class="vector-title" id="vector-title">Group</div>
                <div class="vector-controls">
                    <div class="vector-control">
                        <span class="vector-dot vector-dot-k1"></span>
                        <span class="vector-label">K1</span>
                        <label class="switch switch-sm">
                            <input type="checkbox" id="toggle-k1" checked>
                            <span class="switch-slider"></span>
                        </label>
                    </div>
                    <div class="vector-control">
                        <span class="vector-dot vector-dot-k2"></span>
                        <span class="vector-label">K2</span>
                        <label class="switch switch-sm">
                            <input type="checkbox" id="toggle-k2" checked>
                            <span class="switch-slider"></span>
                        </label>
                    </div>
                    <div class="vector-control">
                        <span class="vector-dot vector-dot-k3"></span>
                        <span class="vector-label">K3</span>
                        <label class="switch switch-sm">
                            <input type="checkbox" id="toggle-k3" checked>
                            <span class="switch-slider"></span>
                        </label>
                    </div>
                    <div class="vector-control">
                        <span class="vector-dot vector-dot-k4"></span>
                        <span class="vector-label">K4</span>
                        <label class="switch switch-sm">
                            <input type="checkbox" id="toggle-k4" checked>
                            <span class="switch-slider"></span>
                        </label>
                    </div>
                </div>
                <div class="vector-actions">
                    <div class="input-group flex-1">
                        <label class="input-label">Set First Vertex</label>
                        <select class="select" id="vector-fv-mode">
                            <option value="bottom">Bottom</option>
                            <option value="top">Top</option>
                            <option value="left">Left</option>
                            <option value="right">Right</option>
                            <option value="ref_firstkey">Lock to first key</option>
                            <option value="custom">Custom</option>
                        </select>
                    </div>
                    <button class="btn btn-secondary btn-xs" id="btn-vector-apply" type="button">Apply</button>
                </div>
                <div class="vector-hint" id="vector-edit-hint">Custom: click a point to set first vertex</div>
                <div class="vector-preview">
                    <svg id="vector-preview" viewBox="0 0 240 240">
                        <rect x="0" y="0" width="240" height="240" rx="8" ry="8" fill="#1f1f1f" stroke="#333" />
                        <g id="vector-paths"></g>
                    </svg>
                </div>
                <div class="vector-meta" id="vector-meta"></div>
            </div>
        </div>
    </div>

    <script src="js/CSInterface.js"></script>
    <script src="js/main.js"></script>
</body>

</html>
